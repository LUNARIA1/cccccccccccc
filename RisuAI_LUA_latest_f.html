<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>RisuAI Lua ìŠ¤í¬ë¦½íŒ… API ì™„ì „ ê°€ì´ë“œ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        h1,
        h2,
        h3,
        h4 {
            color: #333;
            margin-top: 1.5em;
        }

        h1 {
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }

        h2 {
            border-bottom: 2px solid #ddd;
            padding-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }

        blockquote {
            border-left: 4px solid #4CAF50;
            padding-left: 20px;
            margin: 20px 0;
            background-color: #f0f8f0;
            padding: 15px 20px;
        }

        a {
            color: #4CAF50;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 30px 0;
        }

        .hljs-string {
            color: #98c379;
        }

        .hljs-keyword {
            color: #c678dd;
        }

        .hljs-number {
            color: #d19a66;
        }

        .hljs-comment {
            color: #5c6370;
            font-style: italic;
        }

        .hljs-function {
            color: #61afef;
        }

        .toc {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .toc ul {
            list-style-type: none;
            padding-left: 20px;
        }

        .toc>ul {
            padding-left: 0;
        }

        .section {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <h1>RisuAI Lua ìŠ¤í¬ë¦½íŒ… API ì™„ì „ ê°€ì´ë“œ</h1>
    <blockquote>
        <p><strong>ìµœì‹  ë¬¸ì„œ</strong> - RisuAI ì½”ë“œë² ì´ìŠ¤ ë¶„ì„ì„ í†µí•´ ìƒì„±ë¨<br>
            <strong>ì¶œì²˜</strong>: <code>/src/ts/process/scriptings.ts</code> ë° ê´€ë ¨ íŒŒì¼<br>
            <strong>ì‚¬ìš©ë²•</strong>: Lua ìŠ¤í¬ë¦½íŠ¸ëŠ” RisuAI ëª¨ë“ˆ ë° ìºë¦­í„° íŠ¸ë¦¬ê±° ìŠ¤í¬ë¦½íŠ¸(V3 ë˜ëŠ” Lua ì„ íƒ)ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
        </p>
    </blockquote>

    <div class="toc">
        <h2>ëª©ì°¨</h2>
        <ul>
            <li><a href="#overview">1. ê°œìš”</a></li>
            <li><a href="#getting-started">2. ì‹œì‘í•˜ê¸°</a></li>
            <li><a href="#event-handlers">3. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬</a></li>
            <li><a href="#core-api">4. ì½”ì–´ API í•¨ìˆ˜</a></li>
            <li><a href="#chat-management">5. ì±„íŒ… ê´€ë¦¬</a></li>
            <li><a href="#variable-management">6. ë³€ìˆ˜ ê´€ë¦¬</a></li>
            <li><a href="#ui-functions">7. UI í•¨ìˆ˜</a></li>
            <li><a href="#llm-integration">8. LLM í†µí•©</a></li>
            <li><a href="#character-functions">9. ìºë¦­í„° í•¨ìˆ˜</a></li>
            <li><a href="#lorebook-functions">10. ë¡œì–´ë¶ í•¨ìˆ˜</a></li>
            <li><a href="#utility-functions">11. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜</a></li>
            <li><a href="#advanced-features">12. ê³ ê¸‰ ê¸°ëŠ¥</a></li>
            <li><a href="#json-library">13. JSON ë¼ì´ë¸ŒëŸ¬ë¦¬</a></li>
            <li><a href="#best-practices">14. ëª¨ë²” ì‚¬ë¡€</a></li>
            <li><a href="#examples">15. ì˜ˆì‹œ ìŠ¤í¬ë¦½íŠ¸</a></li>
        </ul>
    </div>

    <hr>

    <div class="section" id="overview">
        <h2>ğŸ“Œ 1. ê°œìš”</h2>
        <p>RisuAIì˜ Lua ìŠ¤í¬ë¦½íŒ… ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ë©´ ìºë¦­í„°ì™€ ëª¨ë“ˆì— ëŒ€í•œ ë™ì  ë™ì‘ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Lua ìŠ¤í¬ë¦½íŠ¸ëŠ” ì±„íŒ… ì¡°ì‘, LLM ìƒí˜¸ ì‘ìš© ë“±ì„ ìœ„í•œ í¬ê´„ì ì¸ APIì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”
            ìƒŒë“œë°•ìŠ¤ í™˜ê²½ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.</p>

        <h3>ìŠ¤í¬ë¦½íŠ¸ ìœ í˜•</h3>
        <ul>
            <li><strong>íŠ¸ë¦¬ê±° ìŠ¤í¬ë¦½íŠ¸</strong>: ì´ë²¤íŠ¸ì—ì„œ ì‹¤í–‰ë˜ëŠ” ìºë¦­í„°ë³„ ìŠ¤í¬ë¦½íŠ¸</li>
            <li><strong>ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸</strong>: ëª¨ë“  ì±„íŒ…ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì „ì—­ ìŠ¤í¬ë¦½íŠ¸</li>
            <li><strong>í¸ì§‘ íŠ¸ë¦¬ê±°</strong>: ì…ë ¥/ì¶œë ¥/í‘œì‹œ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸</li>
        </ul>

        <h3>ë³´ì•ˆ ëª¨ë¸</h3>
        <table>
            <tr>
                <th>ì ‘ê·¼ ìˆ˜ì¤€</th>
                <th>ì„¤ëª…</th>
            </tr>
            <tr>
                <td><strong>ì•ˆì „ ì ‘ê·¼ (Safe Access)</strong></td>
                <td>ê¸°ë³¸ ì±„íŒ… ë° ë³€ìˆ˜ ì‘ì—…</td>
            </tr>
            <tr>
                <td><strong>í¸ì§‘ í‘œì‹œ ì ‘ê·¼ (Edit Display Access)</strong></td>
                <td>í‘œì‹œ ì¶œë ¥ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŒ</td>
            </tr>
            <tr>
                <td><strong>ì €ìˆ˜ì¤€ ì ‘ê·¼ (Low Level Access)</strong></td>
                <td>ê³ ê¸‰ ê¸°ëŠ¥(LLM, ì´ë¯¸ì§€ ìƒì„±, ë„¤íŠ¸ì›Œí¬ ìš”ì²­)ì— ëŒ€í•œ ì „ì²´ ì ‘ê·¼</td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="getting-started">
        <h2>ğŸš€ 2. ì‹œì‘í•˜ê¸°</h2>
        <h3>ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡°</h3>
        <pre><code><span class="hljs-comment">-- ë‹¤ì–‘í•œ íŠ¸ë¦¬ê±°ì— ëŒ€í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì •ì˜</span>
<span class="hljs-keyword">function</span> <span class="hljs-function">onStart</span>(id)
    <span class="hljs-comment">-- ì±„íŒ… ì‹œì‘ ì‹œ ì‹¤í–‰</span>
    log(<span class="hljs-string">"ì±„íŒ…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> <span class="hljs-function">onInput</span>(id)
    <span class="hljs-comment">-- ì‚¬ìš©ìê°€ ì…ë ¥ì„ ë³´ë‚¼ ë•Œ ì‹¤í–‰</span>
    log(<span class="hljs-string">"ì‚¬ìš©ì ì…ë ¥ì„ ë°›ì•˜ìŠµë‹ˆë‹¤"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">function</span> <span class="hljs-function">onOutput</span>(id)
    <span class="hljs-comment">-- AIê°€ ì¶œë ¥ì„ ìƒì„±í•œ í›„ ì‹¤í–‰</span>
    log(<span class="hljs-string">"AI ì¶œë ¥ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"</span>)
<span class="hljs-keyword">end</span></code></pre>

        <h3>í¸ì§‘ ë¦¬ìŠ¤ë„ˆ</h3>
        <pre><code><span class="hljs-comment">-- ë‹¤ì–‘í•œ í¸ì§‘ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë‹</span>
listenEdit(<span class="hljs-string">'editInput'</span>, <span class="hljs-keyword">function</span>(id, data, meta)
    <span class="hljs-comment">-- ì²˜ë¦¬ ì „ ì‚¬ìš©ì ì…ë ¥ ìˆ˜ì •</span>
    <span class="hljs-keyword">return</span> data
<span class="hljs-keyword">end</span>)

listenEdit(<span class="hljs-string">'editOutput'</span>, <span class="hljs-keyword">function</span>(id, data, meta)
    <span class="hljs-comment">-- í‘œì‹œ ì „ AI ì¶œë ¥ ìˆ˜ì •</span>
    <span class="hljs-keyword">return</span> data
<span class="hljs-keyword">end</span>)

listenEdit(<span class="hljs-string">'editDisplay'</span>, <span class="hljs-keyword">function</span>(id, data, meta)
    <span class="hljs-comment">-- ìµœì¢… í‘œì‹œ ì¶œë ¥ ìˆ˜ì •</span>
    <span class="hljs-keyword">return</span> data
<span class="hljs-keyword">end</span>)

listenEdit(<span class="hljs-string">'editRequest'</span>, <span class="hljs-keyword">function</span>(id, data, meta)
    <span class="hljs-comment">-- LLMì— ëŒ€í•œ ìš”ì²­ ìˆ˜ì • (dataëŠ” OpenAIChat[] ë°°ì—´)</span>
    <span class="hljs-keyword">return</span> data
<span class="hljs-keyword">end</span>)</code></pre>
    </div>

    <hr>

    <div class="section" id="event-handlers">
        <h2>ğŸ“¡ 3. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬</h2>
        <table>
            <tr>
                <th>í•¸ë“¤ëŸ¬</th>
                <th>ì„¤ëª…</th>
                <th>íŒŒë¼ë¯¸í„°</th>
            </tr>
            <tr>
                <td><code>onStart(id)</code></td>
                <td>ì±„íŒ… ì‹œì‘ ì‹œ íŠ¸ë¦¬ê±°ë¨</td>
                <td><code>id</code>: ì ‘ê·¼ í‚¤</td>
            </tr>
            <tr>
                <td><code>onInput(id)</code></td>
                <td>ì‚¬ìš©ì ì…ë ¥ ì‹œ íŠ¸ë¦¬ê±°ë¨</td>
                <td><code>id</code>: ì ‘ê·¼ í‚¤</td>
            </tr>
            <tr>
                <td><code>onOutput(id)</code></td>
                <td>AI ì¶œë ¥ í›„ íŠ¸ë¦¬ê±°ë¨</td>
                <td><code>id</code>: ì ‘ê·¼ í‚¤</td>
            </tr>
            <tr>
                <td><code>onButtonClick(id, data)</code></td>
                <td>ë²„íŠ¼ í´ë¦­ ì‹œ íŠ¸ë¦¬ê±°ë¨</td>
                <td><code>id</code>: ì ‘ê·¼ í‚¤, <code>data</code>: ë²„íŠ¼ ë°ì´í„°</td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="core-api">
        <h2>âš™ï¸ 4. ì½”ì–´ API í•¨ìˆ˜</h2>
        <h3>ë¡œê¹…</h3>
        <pre><code>log(value)</code></pre>
        <p>ë¸Œë¼ìš°ì € ì½˜ì†”ì— ë°ì´í„°ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.</p>

        <h3>CBS (ì¤‘ê´„í˜¸ êµ¬ë¬¸) íŒŒì„œ</h3>
        <pre><code>result = cbs(value)</code></pre>
        <p>ë¬¸ìì—´ì—ì„œ ì¤‘ê´„í˜¸ êµ¬ë¬¸ì„ íŒŒì‹±í•©ë‹ˆë‹¤ (ì˜ˆ: <code>{{char}}</code>, <code>{{user}}</code>).</p>
        <pre><code><span class="hljs-keyword">local</span> msg = cbs(<span class="hljs-string">"ì•ˆë…•í•˜ì„¸ìš” {{user}}, ì €ëŠ” {{char}}ì…ë‹ˆë‹¤"</span>)
log(msg) <span class="hljs-comment">-- "ì•ˆë…•í•˜ì„¸ìš” í™ê¸¸ë™, ì €ëŠ” ì•¨ë¦¬ìŠ¤ì…ë‹ˆë‹¤"</span></code></pre>
    </div>

    <hr>

    <div class="section" id="chat-management">
        <h2>ğŸ’¬ 5. ì±„íŒ… ê´€ë¦¬</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
                <th>ì‚¬ìš© ì˜ˆì‹œ</th>
            </tr>
            <tr>
                <td><code>getChat(id, index)</code></td>
                <td>ì¸ë±ìŠ¤ë¡œ íŠ¹ì • ì±„íŒ… ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°</td>
                <td><code>getChat(id, -1)</code> â†’ ë§ˆì§€ë§‰ ë©”ì‹œì§€</td>
            </tr>
            <tr>
                <td><code>getFullChat(id)</code></td>
                <td>ëª¨ë“  ì±„íŒ… ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°</td>
                <td><code>getFullChat(id)</code></td>
            </tr>
            <tr>
                <td><code>setChat(id, index, value)</code></td>
                <td>íŠ¹ì • ì±„íŒ… ë©”ì‹œì§€ ìˆ˜ì •</td>
                <td><code>setChat(id, -1, "ìˆ˜ì •ë¨")</code></td>
            </tr>
            <tr>
                <td><code>setChatRole(id, index, role)</code></td>
                <td>íŠ¹ì • ë©”ì‹œì§€ì˜ ì—­í•  ë³€ê²½</td>
                <td><code>setChatRole(id, -1, 'user')</code></td>
            </tr>
            <tr>
                <td><code>setFullChat(id, messages)</code></td>
                <td>ì „ì²´ ì±„íŒ… ê¸°ë¡ ëŒ€ì²´</td>
                <td><code>setFullChat(id, newChat)</code></td>
            </tr>
            <tr>
                <td><code>addChat(id, role, value)</code></td>
                <td>ì±„íŒ…ì— ìƒˆ ë©”ì‹œì§€ ì¶”ê°€</td>
                <td><code>addChat(id, 'char', 'ë©”ì‹œì§€')</code></td>
            </tr>
            <tr>
                <td><code>insertChat(id, index, role, value)</code></td>
                <td>íŠ¹ì • ìœ„ì¹˜ì— ë©”ì‹œì§€ ì‚½ì…</td>
                <td><code>insertChat(id, 0, 'system', '...')</code></td>
            </tr>
            <tr>
                <td><code>removeChat(id, index)</code></td>
                <td>íŠ¹ì • ë©”ì‹œì§€ ì‚­ì œ</td>
                <td><code>removeChat(id, -1)</code></td>
            </tr>
            <tr>
                <td><code>cutChat(id, start, end)</code></td>
                <td>ì§€ì • ë²”ìœ„ë§Œ ìœ ì§€</td>
                <td><code>cutChat(id, 0, 10)</code></td>
            </tr>
            <tr>
                <td><code>getChatLength(id)</code></td>
                <td>ë©”ì‹œì§€ ìˆ˜ ê°€ì ¸ì˜¤ê¸°</td>
                <td><code>getChatLength(id)</code></td>
            </tr>
            <tr>
                <td><code>getCharacterLastMessage(id)</code></td>
                <td>ìºë¦­í„° ë§ˆì§€ë§‰ ë©”ì‹œì§€</td>
                <td><code>getCharacterLastMessage(id)</code></td>
            </tr>
            <tr>
                <td><code>getUserLastMessage(id)</code></td>
                <td>ì‚¬ìš©ì ë§ˆì§€ë§‰ ë©”ì‹œì§€</td>
                <td><code>getUserLastMessage(id)</code></td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="variable-management">
        <h2>ğŸ“Š 6. ë³€ìˆ˜ ê´€ë¦¬</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
                <th>ì‚¬ìš© ì˜ˆì‹œ</th>
            </tr>
            <tr>
                <td><code>getChatVar(id, key)</code></td>
                <td>ì±„íŒ… ë²”ìœ„ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°</td>
                <td><code>getChatVar(id, 'count')</code></td>
            </tr>
            <tr>
                <td><code>setChatVar(id, key, value)</code></td>
                <td>ì±„íŒ… ë²”ìœ„ ë³€ìˆ˜ ì„¤ì •</td>
                <td><code>setChatVar(id, 'count', '42')</code></td>
            </tr>
            <tr>
                <td><code>getGlobalVar(id, key)</code></td>
                <td>ì „ì—­ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°</td>
                <td><code>getGlobalVar(id, 'version')</code></td>
            </tr>
            <tr>
                <td><code>getState(id, name)</code></td>
                <td>ìƒíƒœ ê°€ì ¸ì˜¤ê¸° (ìë™ JSON ë””ì½”ë“œ)</td>
                <td><code>getState(id, 'prefs')</code></td>
            </tr>
            <tr>
                <td><code>setState(id, name, value)</code></td>
                <td>ìƒíƒœ ì„¤ì • (ìë™ JSON ì¸ì½”ë“œ)</td>
                <td><code>setState(id, 'prefs', {theme='dark'})</code></td>
            </tr>
        </table>

        <pre><code><span class="hljs-comment">-- ë³µì¡í•œ ë°ì´í„° ì €ì¥ ì˜ˆì‹œ</span>
setState(id, <span class="hljs-string">'userPrefs'</span>, {
    theme = <span class="hljs-string">'dark'</span>,
    fontSize = <span class="hljs-number">14</span>,
    colors = {<span class="hljs-string">'red'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'green'</span>}
})

<span class="hljs-keyword">local</span> prefs = getState(id, <span class="hljs-string">'userPrefs'</span>)
log(<span class="hljs-string">"í…Œë§ˆ: "</span> .. prefs.theme)</code></pre>
    </div>

    <hr>

    <div class="section" id="ui-functions">
        <h2>ğŸ–¥ï¸ 7. UI í•¨ìˆ˜</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
                <th>ë°˜í™˜ê°’</th>
            </tr>
            <tr>
                <td><code>alertError(id, message)</code></td>
                <td>ì˜¤ë¥˜ ì•Œë¦¼ í‘œì‹œ</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>alertNormal(id, message)</code></td>
                <td>ì¼ë°˜ ì•Œë¦¼ í‘œì‹œ</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>alertInput(id, prompt):await()</code></td>
                <td>ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°</td>
                <td>string</td>
            </tr>
            <tr>
                <td><code>alertSelect(id, options):await()</code></td>
                <td>ì„ íƒ ëŒ€í™”ìƒì</td>
                <td>string</td>
            </tr>
            <tr>
                <td><code>alertConfirm(id, message):await()</code></td>
                <td>í™•ì¸ ëŒ€í™”ìƒì</td>
                <td>boolean</td>
            </tr>
            <tr>
                <td><code>reloadDisplay(id)</code></td>
                <td>ì „ì²´ GUI ìƒˆë¡œê³ ì¹¨</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>reloadChat(id, index)</code></td>
                <td>íŠ¹ì • ë©”ì‹œì§€ ìƒˆë¡œê³ ì¹¨</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>stopChat(id)</code></td>
                <td>í˜„ì¬ ì±„íŒ…/ìƒì„± ì¤‘ì§€</td>
                <td>-</td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="llm-integration">
        <h2>ğŸ¤– 8. LLM í†µí•©</h2>
        <h3>ê°„ë‹¨í•œ LLM í˜¸ì¶œ</h3>
        <pre><code>result = simpleLLM(id, prompt):await()</code></pre>
        <p><strong>íŒŒë¼ë¯¸í„°</strong>: <code>id</code> (ì ‘ê·¼ í‚¤, ì €ìˆ˜ì¤€ ì ‘ê·¼ í•„ìš”), <code>prompt</code> (í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸)<br>
            <strong>ë°˜í™˜ê°’</strong>: <code>{success: boolean, result: string}</code>
        </p>

        <h3>ê³ ê¸‰ LLM í˜¸ì¶œ</h3>
        <pre><code>result = LLM(id, messages, useMultimodal):await()</code></pre>

        <pre><code><span class="hljs-keyword">local</span> messages = {
    {role = <span class="hljs-string">'system'</span>, content = <span class="hljs-string">'ë‹¹ì‹ ì€ ìœ ìš©í•œ ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤'</span>},
    {role = <span class="hljs-string">'user'</span>, content = <span class="hljs-string">'ë†ë‹´ì„ í•´ì£¼ì„¸ìš”'</span>}
}

<span class="hljs-keyword">local</span> result = LLM(id, messages):await()
<span class="hljs-keyword">if</span> result.success <span class="hljs-keyword">then</span>
    log(<span class="hljs-string">"LLM ë‹µë³€: "</span> .. result.result)
<span class="hljs-keyword">end</span></code></pre>

        <h3>ë³´ì¡° LLM í˜¸ì¶œ</h3>
        <pre><code>result = axLLM(id, messages, useMultimodal):await()</code></pre>
        <p>ë³´ì¡° LLM í˜¸ì¶œ ('model' ëŒ€ì‹  'otherAx' ëª¨ë¸ ì‚¬ìš©)</p>
    </div>

    <hr>

    <div class="section" id="character-functions">
        <h2>ğŸ‘¤ 9. ìºë¦­í„° í•¨ìˆ˜</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
                <th>ì ‘ê·¼ ìˆ˜ì¤€</th>
            </tr>
            <tr>
                <td><code>getName(id)</code></td>
                <td>ìºë¦­í„° ì´ë¦„ ê°€ì ¸ì˜¤ê¸°</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>setName(id, name)</code></td>
                <td>ìºë¦­í„° ì´ë¦„ ì„¤ì •</td>
                <td>ì•ˆì „ ì ‘ê·¼</td>
            </tr>
            <tr>
                <td><code>getDescription(id)</code></td>
                <td>ìºë¦­í„° ì„¤ëª… ê°€ì ¸ì˜¤ê¸°</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>setDescription(id, desc)</code></td>
                <td>ìºë¦­í„° ì„¤ëª… ì„¤ì •</td>
                <td>ì•ˆì „ ì ‘ê·¼</td>
            </tr>
            <tr>
                <td><code>getCharacterFirstMessage(id)</code></td>
                <td>ì²« ë²ˆì§¸ ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>setCharacterFirstMessage(id, msg)</code></td>
                <td>ì²« ë²ˆì§¸ ë©”ì‹œì§€ ì„¤ì •</td>
                <td>ì•ˆì „ ì ‘ê·¼</td>
            </tr>
            <tr>
                <td><code>getCharacterImage(id):await()</code></td>
                <td>ìºë¦­í„° ì´ë¯¸ì§€ ì¸ë ˆì´ íƒœê·¸</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>getPersonaName(id)</code></td>
                <td>í˜ë¥´ì†Œë‚˜ ì´ë¦„</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>getPersonaDescription(id)</code></td>
                <td>í˜ë¥´ì†Œë‚˜ ì„¤ëª…</td>
                <td>-</td>
            </tr>
            <tr>
                <td><code>getPersonaImage(id):await()</code></td>
                <td>í˜ë¥´ì†Œë‚˜ ì´ë¯¸ì§€</td>
                <td>-</td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="lorebook-functions">
        <h2>ğŸ“š 10. ë¡œì–´ë¶ í•¨ìˆ˜</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
            </tr>
            <tr>
                <td><code>getLoreBooks(id, search)</code></td>
                <td>ê²€ìƒ‰ ë¬¸ìì—´ê³¼ ì¼ì¹˜í•˜ëŠ” ë¡œì–´ë¶ í•­ëª©</td>
            </tr>
            <tr>
                <td><code>loadLoreBooks(id, reserveTokens):await()</code></td>
                <td>í† í° ì˜ˆì‚° ë‚´ í™œì„± ë¡œì–´ë¶ ë¡œë“œ</td>
            </tr>
            <tr>
                <td><code>upsertLocalLoreBook(id, name, content, options)</code></td>
                <td>ë¡œì»¬ ë¡œì–´ë¶ ìƒì„±/ì—…ë°ì´íŠ¸</td>
            </tr>
        </table>

        <pre><code>upsertLocalLoreBook(id, <span class="hljs-string">"important_fact"</span>, <span class="hljs-string">"í•˜ëŠ˜ì€ íŒŒë—ë‹¤"</span>, {
    alwaysActive = <span class="hljs-keyword">true</span>,
    insertOrder = <span class="hljs-number">50</span>,
    key = <span class="hljs-string">"í•˜ëŠ˜, ë‚ ì”¨"</span>
})</code></pre>
    </div>

    <hr>

    <div class="section" id="utility-functions">
        <h2>ğŸ”§ 11. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜</h2>
        <table>
            <tr>
                <th>í•¨ìˆ˜</th>
                <th>ì„¤ëª…</th>
            </tr>
            <tr>
                <td><code>getTokens(id, text):await()</code></td>
                <td>í…ìŠ¤íŠ¸ í† í° ìˆ˜</td>
            </tr>
            <tr>
                <td><code>sleep(id, ms):await()</code></td>
                <td>ì§€ì • ì‹œê°„ ëŒ€ê¸°</td>
            </tr>
            <tr>
                <td><code>hash(id, text):await()</code></td>
                <td>í…ìŠ¤íŠ¸ í•´ì‹œ ìƒì„±</td>
            </tr>
            <tr>
                <td><code>getAuthorsNote(id)</code></td>
                <td>ì‘ê°€ì˜ ë…¸íŠ¸ ê°€ì ¸ì˜¤ê¸°</td>
            </tr>
            <tr>
                <td><code>getBackgroundEmbedding(id)</code></td>
                <td>ë°°ê²½ HTML ê°€ì ¸ì˜¤ê¸°</td>
            </tr>
            <tr>
                <td><code>setBackgroundEmbedding(id, html)</code></td>
                <td>ë°°ê²½ HTML ì„¤ì •</td>
            </tr>
        </table>
    </div>

    <hr>

    <div class="section" id="advanced-features">
        <h2>ğŸ”¬ 12. ê³ ê¸‰ ê¸°ëŠ¥</h2>
        <h3>ìœ ì‚¬ë„ ê²€ìƒ‰</h3>
        <pre><code>results = similarity(id, source, candidates):await()</code></pre>
        <p>ì„ë² ë”©ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì‚¬í•œ ë¬¸ìì—´ì„ ì°¾ìŠµë‹ˆë‹¤.</p>

        <h3>HTTP ìš”ì²­</h3>
        <pre><code>response = request(id, url):await()</code></pre>
        <p><strong>ì œí•œ</strong>: HTTPSë§Œ, ìµœëŒ€ 120ì, GETë§Œ, ë¶„ë‹¹ 5ê±´</p>

        <h3>ì´ë¯¸ì§€ ìƒì„±</h3>
        <pre><code>imageTag = generateImage(id, prompt, negativePrompt):await()</code></pre>
    </div>

    <hr>

    <div class="section" id="json-library">
        <h2>ğŸ“‹ 13. JSON ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>
        <pre><code><span class="hljs-comment">-- JSON ì¸ì½”ë“œ</span>
<span class="hljs-keyword">local</span> jsonStr = json.encode({name = <span class="hljs-string">"Alice"</span>, age = <span class="hljs-number">30</span>})

<span class="hljs-comment">-- JSON ë””ì½”ë“œ</span>
<span class="hljs-keyword">local</span> data = json.decode(<span class="hljs-string">'{"name":"Bob","score":100}'</span>)
log(data.name) <span class="hljs-comment">-- "Bob"</span></code></pre>
    </div>

    <hr>

    <div class="section" id="best-practices">
        <h2>âœ… 14. ëª¨ë²” ì‚¬ë¡€</h2>
        <h3>1. ë¹„ë™ê¸° í•¨ìˆ˜ì—ëŠ” í•­ìƒ Await ì‚¬ìš©</h3>
        <pre><code><span class="hljs-comment">-- ì˜ëª»ë¨</span>
<span class="hljs-keyword">local</span> result = LLM(id, messages)

<span class="hljs-comment">-- ì˜¬ë°”ë¦„</span>
<span class="hljs-keyword">local</span> result = LLM(id, messages):await()</code></pre>

        <h3>2. ì˜¤ë¥˜ ì²˜ë¦¬</h3>
        <pre><code><span class="hljs-keyword">local</span> success, error = pcall(<span class="hljs-keyword">function</span>()
    <span class="hljs-keyword">local</span> result = simpleLLM(id, <span class="hljs-string">"í…ŒìŠ¤íŠ¸"</span>):await()
    <span class="hljs-keyword">if not</span> result.success <span class="hljs-keyword">then</span>
        alertError(id, <span class="hljs-string">"LLM ì˜¤ë¥˜: "</span> .. result.result)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>)</code></pre>

        <h3>3. ë³µì¡í•œ ë°ì´í„°ì—ëŠ” State ì‚¬ìš©</h3>
        <pre><code>setState(id, <span class="hljs-string">'config'</span>, {enabled = <span class="hljs-keyword">true</span>, maxLength = <span class="hljs-number">100</span>})
<span class="hljs-keyword">local</span> config = getState(id, <span class="hljs-string">'config'</span>)</code></pre>
    </div>

    <hr>

    <div class="section" id="examples">
        <h2>ğŸ“ 15. ì˜ˆì‹œ ìŠ¤í¬ë¦½íŠ¸</h2>
        <h3>ë©”ì‹œì§€ ì¹´ìš´í„°</h3>
        <pre><code><span class="hljs-keyword">function</span> onOutput(id)
    <span class="hljs-keyword">local</span> count = getChatVar(id, <span class="hljs-string">'messageCount'</span>)
    <span class="hljs-keyword">if</span> count == <span class="hljs-string">""</span> <span class="hljs-keyword">then</span> count = <span class="hljs-string">"0"</span> <span class="hljs-keyword">end</span>
    count = tonumber(count) + <span class="hljs-number">1</span>
    setChatVar(id, <span class="hljs-string">'messageCount'</span>, tostring(count))
    <span class="hljs-keyword">if</span> count % <span class="hljs-number">10</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
        alertNormal(id, count .. <span class="hljs-string">"ê°œì˜ ë©”ì‹œì§€ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤!"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre>

        <h3>ìë™ ìš”ì•½</h3>
        <pre><code><span class="hljs-keyword">function</span> onOutput(id)
    <span class="hljs-keyword">local</span> chatLength = getChatLength(id)
    <span class="hljs-keyword">if</span> chatLength % <span class="hljs-number">20</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">local</span> result = simpleLLM(id, <span class="hljs-string">"ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”"</span>):await()
        <span class="hljs-keyword">if</span> result.success <span class="hljs-keyword">then</span>
            setState(id, <span class="hljs-string">'lastSummary'</span>, {summary = result.result})
            alertNormal(id, <span class="hljs-string">"ì±„íŒ…ì´ ìš”ì•½ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>)
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre>
    </div>

    <hr>

    <div class="section">
        <h2>ğŸ“Œ ìš”ì•½</h2>
        <p>RisuAIì˜ Lua ìŠ¤í¬ë¦½íŒ… APIëŠ” ë‹¤ìŒì„ ì œê³µí•©ë‹ˆë‹¤:</p>
        <ul>
            <li>âœ… ë™ì  ì±„íŒ… ì¡°ì‘</li>
            <li>âœ… LLM í†µí•© ë° ì—°ì‡„</li>
            <li>âœ… ìºë¦­í„° ì»¤ìŠ¤í„°ë§ˆì´ì§•</li>
            <li>âœ… ìƒíƒœ ìœ ì§€ ë™ì‘</li>
            <li>âœ… UI ìƒí˜¸ ì‘ìš©</li>
            <li>âœ… ë„¤íŠ¸ì›Œí¬ ìš”ì²­ (ì œí•œì )</li>
            <li>âœ… ì´ë¯¸ì§€ ìƒì„±</li>
            <li>âœ… ë¡œì–´ë¶ ê´€ë¦¬</li>
        </ul>
        <p><strong>ê¸°ì–µí•˜ì„¸ìš”:</strong></p>
        <ul>
            <li>ë¹„ë™ê¸° í•¨ìˆ˜ì—ëŠ” <code>:await()</code> ì‚¬ìš©</li>
            <li><code>pcall</code>ë¡œ ì˜¤ë¥˜ ì²˜ë¦¬</li>
            <li>ë³µì¡í•œ ë°ì´í„°ì—ëŠ” <code>setState</code> ì‚¬ìš©</li>
            <li>ì ‘ê·¼ ìš”êµ¬ ì‚¬í•­ í™•ì¸ (Safe/Low Level)</li>
        </ul>
        <p>ì¦ê±°ìš´ ìŠ¤í¬ë¦½íŒ… ë˜ì„¸ìš”! ğŸš€</p>
    </div>

</body>

</html>